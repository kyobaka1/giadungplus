{% load static %}
<!-- Notification Bell Component -->
<style>
    /* Line clamp utility */
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    /* Notification dropdown animation */
    #notificationDropdown {
        animation: slideDown 0.2s ease-out;
    }
    
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Notification item hover effect */
    .notification-item {
        transition: background-color 0.15s ease;
    }
    
    .notification-item:hover {
        background-color: #f8fafc;
    }
</style>
<div class="relative" id="notificationBellContainer">
    <!-- Bell Button -->
    <button 
        type="button" 
        id="notificationBellButton"
        class="relative p-2 rounded-full hover:bg-slate-100 text-gray-700 transition"
        aria-label="Thông báo"
    >
        <!-- Bell Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
        </svg>
        
        <!-- Badge số lượng chưa đọc -->
        <span 
            id="notificationBadge" 
            class="absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center hidden"
        >
            <span id="notificationCount">0</span>
        </span>
    </button>

    <!-- Dropdown Panel -->
    <div 
        id="notificationDropdown" 
        class="absolute right-0 mt-2 w-80 md:w-96 bg-white rounded-xl shadow-lg border border-slate-200 hidden z-50 max-h-[600px] flex flex-col"
    >
        <!-- Header -->
        <div class="px-4 py-3 border-b border-slate-200 flex items-center justify-between">
            <h3 class="text-sm font-semibold text-slate-800">Thông báo</h3>
            <div class="flex items-center gap-2">
                <button 
                    id="markAllReadButton"
                    class="text-xs text-blue-600 hover:text-blue-700 font-medium"
                    style="display: none;"
                >
                    Đánh dấu tất cả đã đọc
                </button>
                <button 
                    id="closeNotificationButton"
                    class="p-1 rounded hover:bg-slate-100 text-gray-500"
                    aria-label="Đóng"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div id="notificationLoading" class="px-4 py-8 text-center text-sm text-gray-500">
            <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
            <p class="mt-2">Đang tải...</p>
        </div>

        <!-- Empty State -->
        <div id="notificationEmpty" class="px-4 py-8 text-center text-sm text-gray-500 hidden">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 mx-auto text-gray-300 mb-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
            </svg>
            <p>Không có thông báo nào</p>
        </div>

        <!-- Notifications List -->
        <div id="notificationList" class="overflow-y-auto flex-1 hidden">
            <!-- Notifications sẽ được render ở đây bằng JavaScript -->
        </div>

        <!-- Footer -->
        <div class="px-4 py-2 border-t border-slate-200 text-center">
            <a href="#" id="viewAllNotifications" class="text-xs text-blue-600 hover:text-blue-700 font-medium">
                Xem tất cả thông báo
            </a>
        </div>
    </div>
</div>

<!-- Notification Item Template (dùng để clone) -->
<template id="notificationItemTemplate">
    <div class="notification-item px-4 py-3 border-b border-slate-100 hover:bg-slate-50 cursor-pointer transition" data-delivery-id="">
        <div class="flex items-start gap-3">
            <!-- Icon -->
            <div class="flex-shrink-0 mt-0.5">
                <div class="w-2 h-2 rounded-full bg-blue-600 notification-dot"></div>
            </div>
            
            <!-- Content -->
            <div class="flex-1 min-w-0">
                <div class="text-sm font-medium text-slate-800 notification-title"></div>
                <div class="text-xs text-gray-600 mt-1 notification-body line-clamp-2"></div>
                <div class="text-[10px] text-gray-400 mt-1 notification-time"></div>
            </div>
        </div>
    </div>
</template>

