{% load static %}
{% load humanize %}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="Qu·∫£n l√Ω s·∫£n ph·∫©m - Gia D·ª•ng Plus">
    <link rel="icon" href="/static/favicon.png">
    <link rel="shortcut icon" href="/static/favicon.png"/>
    <meta name="msapplication-tap-highlight" content="no">

    <title>{% block title %}S·∫£n ph·∫©m ‚Äì Dashboard{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Tailwind -->
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Averta -->
    <style>
    @font-face {
        font-family: 'Averta';
        src: url('/static/font/AvetaStdCY/AvertaStdCY-Regular.woff2') format('woff2'),
             url('/static/font/AvetaStdCY/AvertaStdCY-Regular.woff') format('woff');
        font-weight: 400;
        font-style: normal;
        font-display: swap;
    }
    @font-face {
        font-family: 'Averta';
        src: url('/static/font/AvetaStdCY/AvertaStdCY-Bold.woff2') format('woff2'),
             url('/static/font/AvetaStdCY/AvertaStdCY-Bold.woff') format('woff');
        font-weight: 700;
        font-style: normal;
        font-display: swap;
    }

    * {
        font-family: 'Averta', sans-serif;
    }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: "#db0d29",
                        brandlight: "#fff1eb"
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-100 text-gray-900 antialiased text-[13px] sm:text-[14px] md:text-[15px]">

<div class="min-h-screen flex flex-col">

    <!-- ‚ñà‚ñÄ TOP BAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <header class="h-14 bg-white border-b shadow-sm flex items-center justify-between px-4">
        <a href="/products/" class="flex items-center gap-2 hover:opacity-90 transition">
            <div class="w-8 h-8 rounded-md overflow-hidden flex justify-center items-center">
                <img src="/static/favicon.png" alt="Logo" class="w-full h-full object-contain">
            </div>

            <div>
                <div class="text-sm font-semibold">Gia D·ª•ng Plus ‚Äì S·∫£n Ph·∫©m</div>
                <div class="text-[11px] text-gray-500 -mt-1">Qu·∫£n L√Ω S·∫£n Ph·∫©m & Ph√¢n Lo·∫°i</div>
            </div>
        </a>

        <div class="flex items-center gap-4">
            <!-- N√∫t chu√¥ng -->
            <button class="relative p-1.5 rounded-full hover:bg-slate-100">
                üîî
                <span class="absolute -top-1 -right-1 text-[10px] bg-red-500 text-white px-1 rounded-full">0</span>
            </button>

            <!-- User info -->
            <div class="flex items-center gap-2 px-2 py-1.5 rounded-full hover:bg-slate-100">
                <div class="w-8 h-8 rounded-full bg-blue-100 flex justify-center items-center text-xs font-semibold text-blue-700">
                    {% if request.user.is_authenticated %}
                        {{ request.user.get_full_name|first|upper }}
                    {% else %}
                        U
                    {% endif %}
                </div>
                <div class="hidden sm:block text-xs leading-tight text-left">
                    <div class="font-medium text-sm">
                        {% if request.user.is_authenticated %}
                            {{ request.user.get_full_name }}
                        {% else %}
                            User
                        {% endif %}
                    </div>
                </div>
            </div>

            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit"
                        class="p-2 rounded-full hover:bg-red-50 text-red-600 transition">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke-width="2"
                         stroke="currentColor"
                         class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
                    </svg>
                </button>
            </form>
        </div>
    </header>

    <!-- ‚ñà‚ñÄ MAIN LAYOUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="flex flex-1 overflow-hidden">

        <!-- SIDEBAR -->
        <aside
            class="bg-white border-r overflow-y-auto flex-shrink-0
                   w-16 sm:w-32 md:w-32 lg:w-48
                   text-[12px] sm:text-[13px]">
            <nav class="py-4 space-y-4">

                <!-- GROUP: S·∫£n ph·∫©m -->
                <div class="px-4 mb-1">
                    <button
                        type="button"
                        class="w-full flex items-center justify-between
                               text-[11px] sm:text-[12px] text-gray-500 font-semibold
                               uppercase tracking-wide mb-2 collapse-toggle"
                        data-collapse-id="menu-products"
                    >
                        <span>DATA S·∫¢N PH·∫®M</span>
                        <span class="collapse-arrow text-xs text-gray-500 transition-transform duration-200 transform">‚ñæ</span>
                    </button>
                    <ul id="menu-products" class="space-y-1">
                        <li>
                            <a href="{% url 'products:product_list' %}"
                               class="flex items-center justify-between px-2.5 py-0.5 rounded-md
                                      hover:bg-brandlight hover:text-brand sidebar-link">
                                <span class="truncate">S·∫£n ph·∫©m</span>
                                <span class="text-[10px] text-gray-500">{{ product_count|default:0 }}</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'products:variant_list' %}"
                               class="flex items-center justify-between px-2.5 py-0.5 rounded-md
                                      hover:bg-brandlight hover:text-brand sidebar-link">
                                <span class="truncate">Ph√¢n lo·∫°i</span>
                                <span class="text-[10px] text-gray-500">{{ variant_count|default:0 }}</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'products:xnk_model_list' %}"
                               class="flex items-center justify-between px-2.5 py-0.5 rounded-md
                                      hover:bg-brandlight hover:text-brand sidebar-link">
                                <span class="truncate">Model XNK</span>
                                <span class="text-[10px] text-gray-500">{{ xnk_model_count|default:0 }}</span>
                            </a>
                        </li>
                    </ul>
                </div>


            </nav>
        </aside>

        <!-- ‚ñà‚ñÄ MAIN CONTENT -->
        <main class="flex-1 overflow-y-auto">
            <div class="px-5 py-4 space-y-6">

                <!-- ‚ñà‚ñÄ OVERVIEW BLOCK -->
                {% block overview %}
                <section>
                    <h1 class="text-lg font-semibold text-slate-800">
                        Qu·∫£n l√Ω s·∫£n ph·∫©m
                    </h1>
                    <p class="text-xs text-gray-500 mt-1">
                        Qu·∫£n l√Ω th√¥ng tin s·∫£n ph·∫©m, ph√¢n lo·∫°i, gi√° v·ªën, t·ªìn kho.
                    </p>
                </section>
                {% endblock %}

                <!-- ‚ñà‚ñÄ CONTENT BLOCK -->
                {% block content %}
                <section>
                    <div class="p-6 bg-white border rounded-xl shadow-sm text-sm text-gray-500">
                        ƒê√¢y l√† n·ªôi dung c·ªßa trang con.
                        S·ª≠ d·ª•ng:
                        <pre class="text-[11px] bg-slate-100 p-3 rounded-md mt-2">
{% verbatim %}{% extends "products/base_products.html" %}
{% block overview %}...{% endblock %}
{% block content %}...{% endblock %}{% endverbatim %}
                        </pre>
                    </div>
                </section>
                {% endblock %}

            </div>
        </main>
    </div>
</div>

<!-- JS toggle sidebar group -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    const toggles = document.querySelectorAll('.collapse-toggle');

    toggles.forEach(function (btn) {
        const id = btn.getAttribute('data-collapse-id');
        const body = document.getElementById(id);
        const arrow = btn.querySelector('.collapse-arrow');

        if (!body) return;

        btn.addEventListener('click', function () {
            const isHidden = body.classList.toggle('hidden');
            if (arrow) {
                if (isHidden) {
                    arrow.classList.add('-rotate-90');
                } else {
                    arrow.classList.remove('-rotate-90');
                }
            }
        });
    });
});
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const currentURL = window.location.pathname;
    const links = document.querySelectorAll('.sidebar-link');

    links.forEach(link => {
        if (link.getAttribute('href') === currentURL) {

            // T√¥ active
            link.classList.add(
                "bg-brandlight",
                "text-brand",
                "font-semibold"
            );

            // T√¨m nh√≥m cha v√† auto m·ªü n√≥
            let parent = link.closest("ul");
            if (parent) {
                parent.classList.remove('hidden');   // m·ªü dropdown

                // Xoay m≈©i t√™n
                const button = parent.previousElementSibling;
                if (button && button.querySelector('.collapse-arrow')) {
                    button.querySelector('.collapse-arrow').classList.remove('-rotate-90');
                }
            }
        }
    });
});
</script>

</body>
</html>


