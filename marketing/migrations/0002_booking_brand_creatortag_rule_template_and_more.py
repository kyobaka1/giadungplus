# Generated by Django 5.0 on 2025-12-10 03:03

import django.db.models.deletion
import django.utils.timezone
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('marketing', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Booking',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('code', models.CharField(db_index=True, max_length=50, unique=True)),
                ('booking_type', models.CharField(choices=[('video_only', 'Video Only'), ('live', 'Live'), ('combo', 'Combo'), ('barter', 'Barter'), ('affiliate_only', 'Affiliate Only')], max_length=50)),
                ('brief_summary', models.TextField(blank=True, null=True)),
                ('contract_file', models.TextField(blank=True, help_text='URL hoặc text path', null=True)),
                ('start_date', models.DateField(blank=True, null=True)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('total_fee_agreed', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('currency', models.CharField(default='VND', max_length=10)),
                ('deliverables_count_planned', models.IntegerField(default=0)),
                ('status', models.CharField(choices=[('negotiating', 'Negotiating'), ('confirmed', 'Confirmed'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('canceled', 'Canceled')], db_index=True, default='negotiating', max_length=50)),
                ('internal_note', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Booking',
                'verbose_name_plural': 'Bookings',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Brand',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('code', models.CharField(db_index=True, help_text='Mã thương hiệu', max_length=50, unique=True)),
                ('name', models.CharField(help_text='Tên thương hiệu', max_length=200)),
                ('description', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Brand',
                'verbose_name_plural': 'Brands',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='CreatorTag',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('name', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Creator Tag',
                'verbose_name_plural': 'Creator Tags',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Rule',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True, null=True)),
                ('scope', models.CharField(choices=[('campaign', 'Campaign'), ('booking', 'Booking'), ('video', 'Video'), ('finance', 'Finance'), ('creator', 'Creator')], max_length=50)),
                ('condition_json', models.JSONField(default=dict, help_text='Condition logic (JSON)')),
                ('action_json', models.JSONField(default=dict, help_text='Action to execute (JSON)')),
                ('is_active', models.BooleanField(db_index=True, default=True)),
            ],
            options={
                'verbose_name': 'Rule',
                'verbose_name_plural': 'Rules',
                'ordering': ['scope', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Template',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('name', models.CharField(max_length=200)),
                ('template_type', models.CharField(choices=[('brief', 'Brief'), ('chat_message', 'Chat Message'), ('email', 'Email'), ('contract', 'Contract'), ('internal_note', 'Internal Note')], max_length=50)),
                ('channel', models.CharField(choices=[('tiktok', 'TikTok'), ('general', 'General')], default='general', max_length=50)),
                ('content', models.TextField(help_text='Markdown/text content')),
                ('variables', models.JSONField(blank=True, default=dict, help_text='Available variables for template')),
                ('is_active', models.BooleanField(db_index=True, default=True)),
            ],
            options={
                'verbose_name': 'Template',
                'verbose_name_plural': 'Templates',
                'ordering': ['template_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='BookingDeliverable',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('deliverable_type', models.CharField(choices=[('video_feed', 'Video Feed'), ('video_story', 'Video Story'), ('live', 'Live'), ('series', 'Series'), ('short', 'Short'), ('other', 'Other')], max_length=50)),
                ('title', models.CharField(max_length=200)),
                ('script_link', models.URLField(blank=True, null=True)),
                ('requirements', models.TextField(blank=True, null=True)),
                ('deadline_shoot', models.DateTimeField(blank=True, null=True)),
                ('deadline_post', models.DateTimeField(blank=True, null=True)),
                ('quantity', models.IntegerField(default=1)),
                ('fee', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('status', models.CharField(choices=[('planned', 'Planned'), ('shooting', 'Shooting'), ('waiting_approve', 'Waiting Approve'), ('scheduled', 'Scheduled'), ('posted', 'Posted'), ('rejected', 'Rejected'), ('canceled', 'Canceled')], db_index=True, default='planned', max_length=50)),
                ('booking', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='deliverables', to='marketing.booking')),
            ],
            options={
                'verbose_name': 'Booking Deliverable',
                'verbose_name_plural': 'Booking Deliverables',
                'ordering': ['deadline_post', 'title'],
            },
        ),
        migrations.CreateModel(
            name='BookingStatusHistory',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('from_status', models.CharField(blank=True, max_length=50, null=True)),
                ('to_status', models.CharField(max_length=50)),
                ('note', models.TextField(blank=True, null=True)),
                ('changed_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('booking', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='status_history', to='marketing.booking')),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Booking Status History',
                'verbose_name_plural': 'Booking Status Histories',
                'ordering': ['-changed_at'],
            },
        ),
        migrations.AddField(
            model_name='booking',
            name='brand',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bookings', to='marketing.brand'),
        ),
        migrations.CreateModel(
            name='Campaign',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('code', models.CharField(db_index=True, max_length=50, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('channel', models.CharField(choices=[('tiktok', 'TikTok'), ('multi', 'Multi-platform')], default='tiktok', max_length=50)),
                ('objective', models.CharField(choices=[('awareness', 'Awareness'), ('traffic', 'Traffic'), ('sale', 'Sale'), ('launch', 'Launch'), ('clearance', 'Clearance')], max_length=50)),
                ('description', models.TextField(blank=True, null=True)),
                ('start_date', models.DateField(blank=True, db_index=True, null=True)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('budget_planned', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('budget_actual', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Denormalized, computed from payments', max_digits=15)),
                ('kpi_view', models.BigIntegerField(default=0, help_text='KPI số lượt xem')),
                ('kpi_order', models.IntegerField(default=0, help_text='KPI số đơn hàng')),
                ('kpi_revenue', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='KPI doanh thu', max_digits=15)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('planned', 'Planned'), ('running', 'Running'), ('paused', 'Paused'), ('finished', 'Finished'), ('canceled', 'Canceled')], db_index=True, default='draft', max_length=50)),
                ('brand', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaigns', to='marketing.brand')),
                ('owner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='owned_campaigns', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Campaign',
                'verbose_name_plural': 'Campaigns',
                'ordering': ['-start_date', 'name'],
            },
        ),
        migrations.AddField(
            model_name='booking',
            name='campaign',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bookings', to='marketing.campaign'),
        ),
        migrations.CreateModel(
            name='Creator',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('name', models.CharField(db_index=True, max_length=200)),
                ('alias', models.CharField(blank=True, max_length=200, null=True)),
                ('gender', models.CharField(blank=True, choices=[('male', 'Nam'), ('female', 'Nữ'), ('other', 'Khác')], max_length=20, null=True)),
                ('dob', models.DateField(blank=True, null=True)),
                ('location', models.CharField(blank=True, max_length=200, null=True)),
                ('niche', models.CharField(blank=True, help_text='Lĩnh vực: beauty, fashion, tech, etc.', max_length=100, null=True)),
                ('note_internal', models.TextField(blank=True, null=True)),
                ('priority_score', models.IntegerField(default=5, help_text='Điểm ưu tiên 1-10')),
                ('status', models.CharField(choices=[('active', 'Active'), ('watchlist', 'Watchlist'), ('blacklist', 'Blacklist')], db_index=True, default='active', max_length=20)),
            ],
            options={
                'verbose_name': 'Creator',
                'verbose_name_plural': 'Creators',
                'ordering': ['-priority_score', 'name'],
                'indexes': [models.Index(fields=['status', 'priority_score'], name='marketing_c_status_c80c66_idx'), models.Index(fields=['niche'], name='marketing_c_niche_214565_idx')],
            },
        ),
        migrations.CreateModel(
            name='CampaignCreator',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('role', models.CharField(choices=[('main', 'Main'), ('supporting', 'Supporting'), ('trial', 'Trial')], default='main', max_length=50)),
                ('note', models.TextField(blank=True, null=True)),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaign_creators', to='marketing.campaign')),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaigns', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Campaign Creator',
                'verbose_name_plural': 'Campaign Creators',
            },
        ),
        migrations.AddField(
            model_name='booking',
            name='creator',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bookings', to='marketing.creator'),
        ),
        migrations.CreateModel(
            name='CreatorChannel',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('platform', models.CharField(choices=[('tiktok', 'TikTok'), ('youtube', 'YouTube'), ('instagram', 'Instagram'), ('shopee_live', 'Shopee Live'), ('other', 'Other')], db_index=True, max_length=50)),
                ('handle', models.CharField(db_index=True, help_text='Username/handle trên platform', max_length=200)),
                ('profile_url', models.URLField(blank=True, null=True)),
                ('external_id', models.CharField(blank=True, db_index=True, help_text='ID từ platform API', max_length=200, null=True)),
                ('follower_count', models.BigIntegerField(default=0, help_text='Số lượng followers')),
                ('avg_view_10', models.IntegerField(default=0, help_text='Average views trong 10 video gần nhất')),
                ('avg_engagement_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='% engagement rate', max_digits=5)),
                ('data_raw', models.JSONField(blank=True, default=dict, help_text='Raw data từ platform API')),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='channels', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Creator Channel',
                'verbose_name_plural': 'Creator Channels',
            },
        ),
        migrations.AddField(
            model_name='booking',
            name='channel',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bookings', to='marketing.creatorchannel'),
        ),
        migrations.CreateModel(
            name='CreatorContact',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('contact_type', models.CharField(choices=[('owner', 'Owner (Chủ kênh)'), ('manager', 'Manager (Quản lý)'), ('agency', 'Agency')], default='owner', max_length=50)),
                ('name', models.CharField(max_length=200)),
                ('phone', models.CharField(blank=True, max_length=50, null=True)),
                ('zalo', models.CharField(blank=True, max_length=100, null=True)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('wechat', models.CharField(blank=True, max_length=100, null=True)),
                ('note', models.TextField(blank=True, null=True)),
                ('is_primary', models.BooleanField(db_index=True, default=False)),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contacts', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Creator Contact',
                'verbose_name_plural': 'Creator Contacts',
            },
        ),
        migrations.CreateModel(
            name='CreatorNote',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('title', models.CharField(max_length=200)),
                ('content', models.TextField(help_text='Markdown content')),
                ('note_type', models.CharField(choices=[('call', 'Call'), ('meeting', 'Meeting'), ('complaint', 'Complaint'), ('compliment', 'Compliment'), ('other', 'Other')], default='other', max_length=50)),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notes', to='marketing.creator')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='creator_notes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Creator Note',
                'verbose_name_plural': 'Creator Notes',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CreatorRateCard',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('deliverable_type', models.CharField(choices=[('video_single', 'Video Single'), ('series', 'Series'), ('live', 'Live'), ('combo', 'Combo'), ('other', 'Other')], max_length=50)),
                ('description', models.TextField(blank=True, null=True)),
                ('price', models.DecimalField(decimal_places=2, max_digits=15)),
                ('currency', models.CharField(default='VND', max_length=10)),
                ('valid_from', models.DateField(blank=True, null=True)),
                ('valid_to', models.DateField(blank=True, null=True)),
                ('channel', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='rate_cards', to='marketing.creatorchannel')),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='rate_cards', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Creator Rate Card',
                'verbose_name_plural': 'Creator Rate Cards',
                'ordering': ['-valid_from', 'creator'],
            },
        ),
        migrations.CreateModel(
            name='CreatorTagMap',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tag_maps', to='marketing.creator')),
                ('tag', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='creator_maps', to='marketing.creatortag')),
            ],
            options={
                'verbose_name': 'Creator Tag Map',
                'verbose_name_plural': 'Creator Tag Maps',
            },
        ),
        migrations.CreateModel(
            name='Payment',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('currency', models.CharField(default='VND', max_length=10)),
                ('exchange_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('amount_vnd', models.DecimalField(blank=True, decimal_places=2, help_text='Computed amount in VND', max_digits=15, null=True)),
                ('payment_date', models.DateField(blank=True, db_index=True, null=True)),
                ('payment_method', models.CharField(choices=[('bank_transfer', 'Bank Transfer'), ('cash', 'Cash'), ('other', 'Other')], default='bank_transfer', max_length=50)),
                ('status', models.CharField(choices=[('planned', 'Planned'), ('pending', 'Pending'), ('paid', 'Paid'), ('canceled', 'Canceled')], db_index=True, default='planned', max_length=50)),
                ('invoice_number', models.CharField(blank=True, max_length=100, null=True)),
                ('note', models.TextField(blank=True, null=True)),
                ('booking', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to='marketing.booking')),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to='marketing.campaign')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_payments', to=settings.AUTH_USER_MODEL)),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Payment',
                'verbose_name_plural': 'Payments',
                'ordering': ['-payment_date', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('code', models.CharField(db_index=True, help_text='Mã sản phẩm (unique within brand)', max_length=100)),
                ('name', models.CharField(max_length=200)),
                ('category', models.CharField(blank=True, max_length=100, null=True)),
                ('sapo_product_id', models.BigIntegerField(blank=True, db_index=True, null=True)),
                ('shopee_id', models.CharField(blank=True, db_index=True, max_length=100, null=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('brand', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='products', to='marketing.brand')),
            ],
            options={
                'verbose_name': 'Product',
                'verbose_name_plural': 'Products',
                'ordering': ['brand', 'name'],
            },
        ),
        migrations.CreateModel(
            name='CampaignProduct',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('priority', models.IntegerField(default=1, help_text='Độ ưu tiên (1 = cao nhất)')),
                ('note', models.TextField(blank=True, null=True)),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaign_products', to='marketing.campaign')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaigns', to='marketing.product')),
            ],
            options={
                'verbose_name': 'Campaign Product',
                'verbose_name_plural': 'Campaign Products',
                'ordering': ['priority', 'product'],
            },
        ),
        migrations.AddField(
            model_name='booking',
            name='product_focus',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bookings', to='marketing.product'),
        ),
        migrations.CreateModel(
            name='RuleLog',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('target_type', models.CharField(choices=[('campaign', 'Campaign'), ('booking', 'Booking'), ('video', 'Video'), ('creator', 'Creator'), ('payment', 'Payment')], max_length=50)),
                ('target_id', models.CharField(db_index=True, help_text='UUID stored as text', max_length=100)),
                ('result', models.CharField(choices=[('matched', 'Matched'), ('not_matched', 'Not Matched'), ('executed', 'Executed')], max_length=50)),
                ('detail', models.JSONField(blank=True, default=dict)),
                ('rule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logs', to='marketing.rule')),
            ],
            options={
                'verbose_name': 'Rule Log',
                'verbose_name_plural': 'Rule Logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='TrackingAsset',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('code_type', models.CharField(choices=[('voucher', 'Voucher Code'), ('link', 'Link'), ('referral_code', 'Referral Code')], db_index=True, max_length=50)),
                ('code_value', models.CharField(db_index=True, max_length=200)),
                ('platform', models.CharField(choices=[('tiktok_shop', 'TikTok Shop'), ('web', 'Web'), ('shopee', 'Shopee'), ('other', 'Other')], db_index=True, max_length=50)),
                ('target_url', models.URLField(blank=True, null=True)),
                ('note', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tracking_assets', to='marketing.booking')),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tracking_assets', to='marketing.campaign')),
                ('creator', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tracking_assets', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Tracking Asset',
                'verbose_name_plural': 'Tracking Assets',
            },
        ),
        migrations.CreateModel(
            name='TrackingConversion',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('order_code', models.CharField(db_index=True, max_length=100)),
                ('order_id_external', models.CharField(blank=True, db_index=True, max_length=200, null=True)),
                ('order_date', models.DateTimeField(db_index=True)),
                ('revenue', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15)),
                ('currency', models.CharField(default='VND', max_length=10)),
                ('source_platform', models.CharField(blank=True, max_length=50, null=True)),
                ('quantity', models.IntegerField(blank=True, null=True)),
                ('data_raw', models.JSONField(blank=True, default=dict)),
                ('product', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conversions', to='marketing.product')),
                ('tracking_asset', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='conversions', to='marketing.trackingasset')),
            ],
            options={
                'verbose_name': 'Tracking Conversion',
                'verbose_name_plural': 'Tracking Conversions',
                'ordering': ['-order_date'],
            },
        ),
        migrations.CreateModel(
            name='Video',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('channel', models.CharField(choices=[('tiktok', 'TikTok'), ('other', 'Other')], db_index=True, default='tiktok', max_length=50)),
                ('platform_video_id', models.CharField(blank=True, db_index=True, help_text='ID từ platform', max_length=200, null=True)),
                ('url', models.URLField(blank=True, null=True)),
                ('title', models.CharField(blank=True, max_length=500, null=True)),
                ('post_date', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('thumbnail_url', models.URLField(blank=True, null=True)),
                ('status', models.CharField(choices=[('posted', 'Posted'), ('deleted', 'Deleted'), ('hidden', 'Hidden'), ('pending', 'Pending')], db_index=True, default='posted', max_length=50)),
                ('booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='videos', to='marketing.booking')),
                ('booking_deliverable', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='videos', to='marketing.bookingdeliverable')),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='videos', to='marketing.campaign')),
                ('creator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='videos', to='marketing.creator')),
            ],
            options={
                'verbose_name': 'Video',
                'verbose_name_plural': 'Videos',
                'ordering': ['-post_date'],
            },
        ),
        migrations.CreateModel(
            name='VideoMetricSnapshot',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('snapshot_time', models.DateTimeField(db_index=True)),
                ('view_count', models.BigIntegerField(default=0)),
                ('like_count', models.BigIntegerField(default=0)),
                ('comment_count', models.BigIntegerField(default=0)),
                ('share_count', models.BigIntegerField(default=0)),
                ('save_count', models.BigIntegerField(default=0)),
                ('engagement_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('data_raw', models.JSONField(blank=True, default=dict)),
                ('video', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='snapshots', to='marketing.video')),
            ],
            options={
                'verbose_name': 'Video Metric Snapshot',
                'verbose_name_plural': 'Video Metric Snapshots',
                'ordering': ['-snapshot_time'],
            },
        ),
        migrations.AddIndex(
            model_name='campaign',
            index=models.Index(fields=['brand', 'start_date'], name='marketing_c_brand_i_fe292d_idx'),
        ),
        migrations.AddIndex(
            model_name='campaign',
            index=models.Index(fields=['status', 'start_date'], name='marketing_c_status_221ab7_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='campaigncreator',
            unique_together={('campaign', 'creator')},
        ),
        migrations.AddIndex(
            model_name='creatorchannel',
            index=models.Index(fields=['platform', 'external_id'], name='marketing_c_platfor_7347ba_idx'),
        ),
        migrations.AddIndex(
            model_name='creatorchannel',
            index=models.Index(fields=['creator', 'platform'], name='marketing_c_creator_462403_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='creatorchannel',
            unique_together={('platform', 'handle')},
        ),
        migrations.AddIndex(
            model_name='creatorcontact',
            index=models.Index(fields=['creator', 'is_primary'], name='marketing_c_creator_a16b6f_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='creatortagmap',
            unique_together={('creator', 'tag')},
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['campaign', 'payment_date'], name='marketing_p_campaig_278e7e_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['creator', 'payment_date'], name='marketing_p_creator_e86270_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['status', 'payment_date'], name='marketing_p_status_6e6aea_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['brand', 'code'], name='marketing_p_brand_i_e1abab_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['is_active'], name='marketing_p_is_acti_e5eb9b_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='product',
            unique_together={('brand', 'code')},
        ),
        migrations.AlterUniqueTogether(
            name='campaignproduct',
            unique_together={('campaign', 'product')},
        ),
        migrations.AddIndex(
            model_name='booking',
            index=models.Index(fields=['campaign', 'status'], name='marketing_b_campaig_799e1d_idx'),
        ),
        migrations.AddIndex(
            model_name='booking',
            index=models.Index(fields=['creator', 'status'], name='marketing_b_creator_9d978d_idx'),
        ),
        migrations.AddIndex(
            model_name='rulelog',
            index=models.Index(fields=['rule', 'target_type', 'target_id'], name='marketing_r_rule_id_8ced17_idx'),
        ),
        migrations.AddIndex(
            model_name='trackingasset',
            index=models.Index(fields=['campaign', 'is_active'], name='marketing_t_campaig_5f7d62_idx'),
        ),
        migrations.AddIndex(
            model_name='trackingasset',
            index=models.Index(fields=['creator', 'is_active'], name='marketing_t_creator_5e3d48_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='trackingasset',
            unique_together={('platform', 'code_type', 'code_value')},
        ),
        migrations.AddIndex(
            model_name='trackingconversion',
            index=models.Index(fields=['tracking_asset', 'order_date'], name='marketing_t_trackin_9232e5_idx'),
        ),
        migrations.AddIndex(
            model_name='trackingconversion',
            index=models.Index(fields=['order_code'], name='marketing_t_order_c_0dadaf_idx'),
        ),
        migrations.AddIndex(
            model_name='video',
            index=models.Index(fields=['campaign', 'post_date'], name='marketing_v_campaig_f05db6_idx'),
        ),
        migrations.AddIndex(
            model_name='video',
            index=models.Index(fields=['creator', 'post_date'], name='marketing_v_creator_58143b_idx'),
        ),
        migrations.AddIndex(
            model_name='video',
            index=models.Index(fields=['channel', 'platform_video_id'], name='marketing_v_channel_690454_idx'),
        ),
        migrations.AddIndex(
            model_name='videometricsnapshot',
            index=models.Index(fields=['video', 'snapshot_time'], name='marketing_v_video_i_c0fd6f_idx'),
        ),
    ]
